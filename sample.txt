package com.cucumber.utils;

import com.itextpdf.text.*;
import com.itextpdf.text.pdf.PdfWriter;
import com.cucumber.base.BaseClass;

import java.io.FileOutputStream;
import java.util.List;
import java.util.Map;

public class PdfGenerator {

    public static void generatePdf(String outputPath) {
        try {
            Document document = new Document();
            PdfWriter.getInstance(document, new FileOutputStream(outputPath));
            document.open();

            for (Map.Entry<String, List<String>> entry : BaseClass.scenarioScreenshots.entrySet()) {
                String scenarioName = entry.getKey();
                List<String> screenshots = entry.getValue();

                // Add Scenario Title
                Paragraph title = new Paragraph("Scenario: " + scenarioName, 
                        FontFactory.getFont(FontFactory.HELVETICA_BOLD, 14, BaseColor.BLUE));
                title.setSpacingAfter(10);
                document.add(title);

                // Add each screenshot under the scenario
                for (String screenshotPath : screenshots) {
                    Image img = Image.getInstance(screenshotPath);
                    img.scaleToFit(500, 400);
                    img.setSpacingAfter(10);
                    document.add(img);
                }

                // Page break between scenarios
                document.newPage();
            }

            document.close();
            System.out.println("PDF Generated at: " + outputPath);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
