public void safeClick(By locator) {

    try {
        // Wait for loader to disappear (safe optional wait)
        try {
            WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));
            wait.until(ExpectedConditions.invisibilityOfElementLocated(By.cssSelector(".loading-icon")));
        } catch (Exception ignore) {
            // If loader not found, continue
        }

        WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(15));

        // Wait for element to be clickable
        WebElement element = wait.until(ExpectedConditions.elementToBeClickable(locator));

        // Scroll into view
        ((JavascriptExecutor) driver).executeScript(
                "arguments[0].scrollIntoView({behavior:'smooth', block:'center'});",
                element
        );

        // Normal click attempt
        element.click();

    } catch (ElementClickInterceptedException e) {

        // JS click fallback
        WebElement element = driver.findElement(locator);
        ((JavascriptExecutor) driver).executeScript("arguments[0].click();", element);

    } catch (Exception e) {

        // Final fallback: JS click
        WebElement element = driver.findElement(locator);
        ((JavascriptExecutor) driver).executeScript("arguments[0].click();", element);
    }
}
