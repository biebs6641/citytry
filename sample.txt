package com.mycompany.hooks;

import com.mycompany.base.ConfigReader;
import com.mycompany.base.DriverFactory;
import com.mycompany.base.ExtentManager;
import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.ExtentTest;

import io.cucumber.java.Before;
import io.cucumber.java.After;
import io.cucumber.java.Scenario;

public class Hooks {
    public static ExtentReports extent;
    public static ExtentTest test;

    @Before
    public void setup(Scenario scenario) {
        extent = ExtentManager.getInstance();
        test = extent.createTest(scenario.getName());
        String browser = ConfigReader.getProperty("browser");
        DriverFactory.initDriver(browser);
    }

    @After
    public void teardown(Scenario scenario) {
        if (scenario.isFailed()) {
            String screenshotPath = "test-output/screenshots/" + scenario.getName() + ".png";
            DriverFactory.getDriver(); // Capture screenshot logic can be added here
            test.fail("Scenario Failed"); // attach screenshot if implemented
        } else {
            test.pass("Scenario Passed");
        }
        DriverFactory.quitDriver();
        extent.flush(); // ensures latest report
    }
}
