private void waitForDOMToSettle(int milliseconds) {
    try {
        long endTime = System.currentTimeMillis() + milliseconds;
        while (System.currentTimeMillis() < endTime) {
            ((JavascriptExecutor) webDriver).executeScript("return document.readyState").equals("complete");
            Thread.sleep(100);
        }
    } catch (InterruptedException e) {
        // Ignore
    }
}
