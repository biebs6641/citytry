public boolean isInteractable(WebElement element) {
    try {
        JavascriptExecutor js = (JavascriptExecutor) driver;
        return (Boolean) js.executeScript(
            "try {" +
            "  let rect = arguments[0].getBoundingClientRect();" +
            "  let x = rect.left + rect.width/2;" +
            "  let y = rect.top + rect.height/2;" +
            "  let ev = new MouseEvent('mousedown', {clientX:x, clientY:y, bubbles:true});" +
            "  return arguments[0].dispatchEvent(ev);" +
            "} catch(e) { return false; }",
            element
        );
    } catch (Exception e) {
        return false;
    }
}


public WebElement findActiveElement(By locator) {
    List<WebElement> elements = driver.findElements(locator);
    for (WebElement e : elements) {
        if (isInteractable(e)) {
            return e;  // THE REAL ACTIVE ONE
        }
    }
    return null;
}




