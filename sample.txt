package com.cucumber.base;

import com.itextpdf.text.*;
import com.itextpdf.text.pdf.PdfWriter;

import java.io.FileOutputStream;
import java.util.List;

public class PdfReportGenerator {

    public static void createPdfFromScreenshots(String outputPdfPath) {
        try {
            Document document = new Document();
            PdfWriter.getInstance(document, new FileOutputStream(outputPdfPath));
            document.open();

            List<String> screenshots = BaseClass.getScreenshotPaths();

            if (!screenshots.isEmpty()) {
                for (String path : screenshots) {
                    Image image = Image.getInstance(path);
                    image.scaleToFit(PageSize.A4.getWidth() - 50, PageSize.A4.getHeight() - 50);
                    image.setAlignment(Element.ALIGN_CENTER);

                    document.add(new Paragraph("Screenshot: " + new File(path).getName()));
                    document.add(image);
                    document.add(Chunk.NEWLINE);
                }
            } else {
                document.add(new Paragraph("No screenshots captured in this scenario."));
            }

            document.close();
            System.out.println("PDF created: " + outputPdfPath);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
